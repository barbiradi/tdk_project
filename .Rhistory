threshold_covid_start <- as.Date("2020-03-11")
threshold_covid_end <- as.Date("2021-12-31")
my_data_covid2 <- my_data %>%
filter(
str_detect(title,regex(patterns,ignore_case = TRUE)) |
str_detect(keywords,regex(patterns,ignore_case = TRUE))
) %>%
mutate(
article_date =as.Date(article_date)
) %>%
filter(
article_date >= threshold_covid_start,
article_date <= threshold_covid_end
)
my_data_control_covid = my_data %>%
filter(
article_date >= threshold_covid_start,
article_date <= threshold_covid_end
) %>%
semi_join(my_data_covid2, by= "journal") %>%
filter(!(str_detect(title, regex(patterns,ignore_case = TRUE)) |
str_detect(keywords, regex(patterns, ignore_case = TRUE))
))
my_data_covid2 = my_data_covid2 %>%
mutate(journal = factor(journal))
levels(my_data_covid2$journal)
my_data_control_covid = my_data_control_covid %>%
mutate(journal = factor(journal))
levels(my_data_control_covid$journal)
my_data_control_covid_sliced = my_data_control_covid %>%
slice_sample(n = nrow(my_data_covid2)) %>%
arrange(article_date)
my_data_control_covid_sliced %>%
ggplot(aes(x = article_date, y = acceptance_delay)) +
geom_point() +
geom_smooth()
my_data_covid2 %>%
ggplot(aes(x = article_date, y = acceptance_delay)) +
geom_point() +
geom_smooth()
my_data_ai2 %>%
ggplot()+
aes(x = acceptance_delay)+
geom_histogram(binwidth = 5)
my_data_control_AI %>%
ggplot()+
aes(x = acceptance_delay)+
geom_histogram()
threshold_covid_end <- as.Date("2022-12-31")
my_data_covid2 <- my_data %>%
filter(
str_detect(title,regex(patterns,ignore_case = TRUE)) |
str_detect(keywords,regex(patterns,ignore_case = TRUE))
) %>%
mutate(
article_date =as.Date(article_date)
) %>%
filter(
article_date >= threshold_covid_start,
article_date <= threshold_covid_end
)
my_data_control_covid = my_data %>%
filter(
article_date >= threshold_covid_start,
article_date <= threshold_covid_end
) %>%
semi_join(my_data_covid2, by= "journal") %>%
filter(!(str_detect(title, regex(patterns,ignore_case = TRUE)) |
str_detect(keywords, regex(patterns, ignore_case = TRUE))
))
my_data_covid2 = my_data_covid2 %>%
mutate(journal = factor(journal))
View(my_data_control_covid)
my_data_control_covid = my_data %>%
filter(
article_date >= threshold_covid_start,
article_date <= threshold_covid_end
) %>%
semi_join(my_data_covid2, by= "journal") %>%
filter(!(str_detect(title, regex(patterns_COVID,ignore_case = TRUE)) |
str_detect(keywords, regex(patterns_COVID, ignore_case = TRUE))
))
patterns_COVID <- "COVID-19|Covid19|\\bCovid\\b|Coronavirus|Corona virus|SARS-CoV-2|\\bSARS\\b|SARS-CoV|2019-ncov"
patterns_COVID <- "COVID-19|Covid19|\\bCovid\\b|Coronavirus|Corona virus|SARS-CoV-2|\\bSARS\\b|SARS-CoV|2019-ncov"
my_data_covid1 <- my_data %>%
filter(
str_detect(title,regex(patterns_COVID,ignore_case = TRUE)) |
str_detect(keywords,regex(patterns_COVID,ignore_case = TRUE))
) %>%
mutate(
article_date =as.Date(article_date)
)
threshold_covid_start <- as.Date("2020-03-11")
threshold_covid_end <- as.Date("2022-12-31")
my_data_covid2 <- my_data %>%
filter(
str_detect(title,regex(patterns,ignore_case = TRUE)) |
str_detect(keywords,regex(patterns,ignore_case = TRUE))
) %>%
mutate(
article_date =as.Date(article_date)
) %>%
filter(
article_date >= threshold_covid_start,
article_date <= threshold_covid_end
)
my_data_control_covid = my_data %>%
filter(
article_date >= threshold_covid_start,
article_date <= threshold_covid_end
) %>%
semi_join(my_data_covid2, by= "journal") %>%
filter(!(str_detect(title, regex(patterns_COVID,ignore_case = TRUE)) |
str_detect(keywords, regex(patterns_COVID, ignore_case = TRUE))
))
my_data_covid2 = my_data_covid2 %>%
mutate(journal = factor(journal))
my_data_RUwar1 <- my_data %>%
filter(
str_detect(title,regex(patterns_RUwar,ignore_case = TRUE)) |
str_detect(keywords,regex(patterns_RUwar,ignore_case = TRUE))
) %>%
mutate(
article_date =as.Date(article_date)
)
patterns_RUwar <- "Russia-Ukraine war|Russo-Ukrainian war|Russian-Ukrainian conflict|Russian conflict|Ukrainian conflict|Russian invasion|Russian war|Ukrainian war|Russian attack|Russia|Ukraine|Donbas conflict|Donbas war|Donbas|Luhansk|war in Eastern Ukraine|Russian offensive|Ukrainian offensive|Ukraine humanitarian crisis|Crimea invasion"
my_data_RUwar1 <- my_data %>%
filter(
str_detect(title,regex(patterns_RUwar,ignore_case = TRUE)) |
str_detect(keywords,regex(patterns_RUwar,ignore_case = TRUE))
) %>%
mutate(
article_date =as.Date(article_date)
)
threshold_RUwar_start <- as.Date("2022-02-24")
threshold_RUwar_end <- max(my_data$article_date, na.rm = TRUE)
my_data_RUwar2 <- my_data %>%
filter(
str_detect(title,regex(patterns_2,ignore_case = TRUE)) |
str_detect(keywords,regex(patterns_2,ignore_case = TRUE))
) %>%
mutate(
article_date =as.Date(article_date)
) %>%
filter(
article_date >= threshold_RUwar_start,
article_date <= threshold_RUwar_end
)
my_data_control_RUwar = my_data %>%
filter(
article_date >= threshold_RUwar_start,
article_date <= threshold_RUwar_end
) %>%
semi_join(my_data_RUwar2, by= "journal") %>%
filter(!(str_detect(title, regex(patterns_2,ignore_case = TRUE)) |
str_detect(keywords, regex(patterns_2, ignore_case = TRUE))
))
my_data_RUwar2 = my_data_RUwar2 %>%
mutate(journal = factor(journal))
my_data_control_RUwar = my_data_control_RUwar %>%
mutate(journal = factor(journal))
my_data_control_RUwar_sliced = my_data_control_RUwar %>%
slice_sample(n = nrow(my_data_RUwar2)) %>%
arrange(article_date)
boot_samples_COVID <- replicate(1000,
my_data_control_covid[sample(1:nrow(my_data_control_covid), nrow(my_data_covid2), replace = TRUE), ],
simplify = FALSE
)
boot_means_covid_sample <- data.frame(
bootstrap_id = 1:length(boot_samples_COVID),
mean_acceptance_delay = sapply(boot_samples_COVID, \(df) mean(df$acceptance_delay, na.rm = TRUE))
)
ci_covid <- quantile(boot_means_covid_sample$mean_acceptance_delay,
probs = c(0.025, 0.975))
ci_covid
mean(my_data_covid2$acceptance_delay)
View(my_data_RUwar1)
View(my_data_covid1)
my_data_RUwar1 <- my_data %>%
filter(
str_detect(title,regex(patterns_RUwar,ignore_case = TRUE)) |
str_detect(keywords,regex(patterns_RUwar,ignore_case = TRUE))
) %>%
mutate(
article_date =as.Date(article_date)
)
my_data_RUwar2 <- my_data %>%
filter(
str_detect(title,regex(patterns_2,ignore_case = TRUE)) |
str_detect(keywords,regex(patterns_2,ignore_case = TRUE))
) %>%
mutate(
article_date =as.Date(article_date)
) %>%
filter(
article_date > threshold_RUwar_start,
article_date < threshold_RUwar_end
)
my_data_RUwar2 <- my_data %>%
filter(
str_detect(title,regex(patterns_RUwar,ignore_case = TRUE)) |
str_detect(keywords,regex(patterns_RUwar,ignore_case = TRUE))
) %>%
mutate(
article_date =as.Date(article_date)
) %>%
filter(
article_date > threshold_RUwar_start,
article_date < threshold_RUwar_end
)
my_data_control_RUwar = my_data %>%
filter(
article_date >= threshold_RUwar_start,
article_date <= threshold_RUwar_end
) %>%
semi_join(my_data_RUwar2, by= "journal") %>%
filter(!(str_detect(title, regex(patterns_2,ignore_case = TRUE)) |
str_detect(keywords, regex(patterns_2, ignore_case = TRUE))
))
my_data_RUwar2 = my_data_RUwar2 %>%
mutate(journal = factor(journal))
levels(my_data_RUwar2$journal)
my_data_control_RUwar = my_data_control_RUwar %>%
mutate(journal = factor(journal))
boot_samples_RUwar <- replicate(1000,
my_data_control_RUwar[sample(1:nrow(my_data_control_RUwar), nrow(my_data_RUwar2), replace = TRUE), ],
simplify = FALSE
)
mean(my_data_RUwar2$acceptance_delay)
ci_RUwar
ci_RUwar <- quantile(boot_means_df_RUwar$mean_acceptance_delay,
probs = c(0.025, 0.975))
ci_RUwar
boot_samples_RUwar <- replicate(1000,
my_data_control_RUwar[sample(1:nrow(my_data_control_RUwar), nrow(my_data_RUwar2), replace = TRUE), ],
simplify = FALSE
)
boot_means_df_RUwar <- data.frame(
bootstrap_id = 1:length(boot_samples_RUwar),
mean_acceptance_delay = sapply(boot_samples_RUwar, \(df) mean(df$acceptance_delay, na.rm = TRUE))
)
ci_RUwar <- quantile(boot_means_df_RUwar$mean_acceptance_delay,
probs = c(0.025, 0.975))
ci_RUwar
mean(my_data_RUwar2$acceptance_delay)
ggplot(boot_means_covid_sample, aes(x = mean_acceptance_delay)) +
geom_histogram(bins = 30, fill = "skyblue", color = "black", alpha = 0.7) +
geom_vline(xintercept = ci_covid, color = "red", linetype = "dashed", linewidth = 1) +
geom_vline(xintercept = mean(my_data_covid2$acceptance_delay),
color = "darkgreen", linetype = "solid", size = 1.2) +
annotate("text",
x = mean(my_data_covid2$acceptance_delay),
y = max(table(cut(boot_means_covid_sample$mean_acceptance_delay, breaks = 30))) * 0.9,
label = "Sample Mean",
color = "darkgreen",
angle = 90,
vjust = -0.5) +
labs(title = "Bootstrap Distribution of Mean Acceptance Delay (COVID)",
x = "Mean Acceptance Delay",
y = "Frequency") +
theme_minimal()
ggplot(boot_means_df_RUwar, aes(x = mean_acceptance_delay)) +
geom_histogram(bins = 30, fill = "skyblue", color = "black", alpha = 0.7) +
geom_vline(xintercept = ci_RUwar, color = "red", linetype = "dashed", linewidth = 1) +
geom_vline(xintercept = mean(my_data_RUwar2$acceptance_delay),
color = "darkgreen", linetype = "solid", size = 1.2) +
annotate("text",
x = mean(my_data_RUwar2$acceptance_delay),
y = max(table(cut(boot_means_df_RUwar$mean_acceptance_delay, breaks = 30))) * 0.9,
label = "Sample Mean",
color = "darkgreen",
angle = 90,
vjust = -0.5) +
labs(title = "Bootstrap Distribution of Mean Acceptance Delay (RU War)",
x = "Mean Acceptance Delay",
y = "Frequency") +
theme_minimal()
my_data_ai1 %>%
ggplot()+
aes(x = article_date, )+
geom_histogram()
my_data_ai1 %>%
ggplot()+
aes(x = article_date, fill = IQR )+
geom_histogram()
my_data_ai1 %>%
ggplot()+
aes(x = article_date,  )+
geom_histogram()
ci_AI_sampling <- quantile(my_data_ai1$article_date,
probs = c(0.025, 0.975))
ci_AI_sampling <- quantile(my_data_ai1$as.numeric(article_date),
probs = c(0.025, 0.975))
ci_AI_sampling <- my_data_ai1 %>%
mutate(article_date = as.numeric(article_date)) %>%
quantile(my_data_ai1$as.numeric(article_date),
probs = c(0.025, 0.975))
summarise(
ci = list(quantile(mean_acceptance_delay, c(0.025, 0.975)))
) %>%
pull(ci) %>%
unlist()
summarise(
ci = list(quantile(article_date, c(0.025, 0.975)))
) %>%
pull(ci) %>%
unlist()
ci_AI_date <- my_data_ai1 %>%
mutate(article_date = as.numeric(article_date)) %>%
summarise(
ci = list(quantile(article_date, c(0.025, 0.975)))
) %>%
pull(ci) %>%
unlist()
ci_AI_date
ci_AI_date <- my_data_ai1 %>%
mutate(article_date = as.numeric(article_date)) %>%
summarise(
ci = list(quantile(article_date, c(0.05, 1)))
) %>%
pull(ci) %>%
unlist()
ci_AI_date
date_bounds <- my_data_ai1 %>%
summarise(
lower = quantile(article_date, 0.025, na.rm = TRUE),
upper = quantile(article_date, 0.975, na.rm = TRUE)
)
date_bounds <- my_data_ai1 %>%
mutate(article_date = as.numeric(article_date)) %>%
summarise(
lower = quantile(article_date, 0.025, na.rm = TRUE),
upper = quantile(article_date, 0.975, na.rm = TRUE)
) %>%
mutate(article_date = as.Date(article_date))
date_bounds <- my_data_ai1 %>%
mutate(article_date = as.numeric(article_date)) %>%
summarise(
lower = quantile(article_date, 0.025, na.rm = TRUE),
upper = quantile(article_date, 0.975, na.rm = TRUE)
) %>%
mutate(lower = as.Date(lower)| upper = as.Date(upper))
date_bounds <- my_data_ai1 %>%
mutate(article_date = as.numeric(article_date)) %>%
summarise(
lower = quantile(article_date, 0.025, na.rm = TRUE),
upper = quantile(article_date, 0.975, na.rm = TRUE)
) %>%
mutate(lower = as.Date(lower)) %>%
mutate(upper = as.Date(upper))
date_bounds
date_bounds <- my_data_ai1 %>%
mutate(article_date = as.numeric(article_date)) %>%
summarise(
lower = quantile(article_date, 0.1, na.rm = TRUE),
upper = quantile(article_date, 0.975, na.rm = TRUE)
) %>%
mutate(lower = as.Date(lower)) %>%
mutate(upper = as.Date(upper))
date_bounds
date_bounds <- my_data_ai1 %>%
mutate(date_num = as.numeric(article_date)) %>%
summarise(
lower = as.Date(quantile(date_num, 0.025, na.rm = TRUE), origin = "1970-01-01"),
upper = as.Date(quantile(date_num, 0.975, na.rm = TRUE), origin = "1970-01-01")
)
date_bounds
date_bounds_elections <- my_data_elections1 %>%
mutate(date_num = as.numeric(article_date)) %>%
summarise(
lower = as.Date(quantile(date_num, 0.025, na.rm = TRUE), origin = "1970-01-01"),
upper = as.Date(quantile(date_num, 0.975, na.rm = TRUE), origin = "1970-01-01")
)
date_bounds_elections
date_bounds_covid <- my_data_covid1 %>%
mutate(date_num = as.numeric(article_date)) %>%
summarise(
lower = as.Date(quantile(date_num, 0.025, na.rm = TRUE), origin = "1970-01-01"),
upper = as.Date(quantile(date_num, 0.975, na.rm = TRUE), origin = "1970-01-01")
)
date_bounds_covid
date_bounds_RUwawr <- my_data_RUwar1 %>%
mutate(date_num = as.numeric(article_date)) %>%
summarise(
lower = as.Date(quantile(date_num, 0.025, na.rm = TRUE), origin = "1970-01-01"),
upper = as.Date(quantile(date_num, 0.975, na.rm = TRUE), origin = "1970-01-01")
)
date_bounds_RUwar <- my_data_RUwar1 %>%
mutate(date_num = as.numeric(article_date)) %>%
summarise(
lower = as.Date(quantile(date_num, 0.025, na.rm = TRUE), origin = "1970-01-01"),
upper = as.Date(quantile(date_num, 0.975, na.rm = TRUE), origin = "1970-01-01")
)
date_bounds_RUwar
my_data_covid1 %>%
ggplot()+
aes(x = article_date,  )+
geom_histogram()
my_data_RUWar1 %>%
ggplot()+
aes(x = article_date,  )+
geom_histogram()
my_data_RUwar1 %>%
ggplot()+
aes(x = article_date,  )+
geom_histogram()
df_ai <- my_data_ai2 %>% mutate(source = "AI")
df_elections <- my_data_elections2 %>% mutate(source = "Elections")
df_covid <- my_data_covid2 %>% mutate(source = "COVID")
df_ruwar <- my_data_RUwar2 %>% mutate(source = "RUwar")
all_data <- bind_rows(df_ai, df_elections, df_covid, df_ruwar)
library(lubridate)
# 3. Combine datasets
all_data <- bind_rows(df_ai, df_elections, df_covid, df_ruwar)
# 1. Standardize date formats in each dataframe
my_data_ai2        <- my_data_ai2        %>% mutate(article_date = as.Date(article_date))
my_data_elections2 <- my_data_elections2 %>% mutate(article_date = as.Date(article_date))
my_data_covid2     <- my_data_covid2     %>% mutate(article_date = as.Date(article_date))
my_data_RUwar2     <- my_data_RUwar2     %>% mutate(article_date = as.Date(article_date))
# 2. Add source labels
df_ai        <- my_data_ai2        %>% mutate(source = "AI")
df_elections <- my_data_elections2 %>% mutate(source = "Elections")
df_covid     <- my_data_covid2     %>% mutate(source = "COVID")
df_ruwar     <- my_data_RUwar2     %>% mutate(source = "RUwar")
# 3. Combine datasets
all_data <- bind_rows(df_ai, df_elections, df_covid, df_ruwar)
# 3. Combine datasets
all_data <- bind_rows(df_ai, df_elections, df_covid, df_ruwar)
my_data_covid2     <- my_data_covid2     %>% mutate(article_date = as.Date(article_date))
df_covid     <- my_data_covid2     %>% mutate(source = "COVID")
levels(df_covid)
class(df_covid$article_date)
# 3. Combine datasets
all_data <- bind_rows(df_ai, df_elections, df_covid, df_ruwar)
class(df_ai$article_date)
class(df_elections$article_date)
class(df_ruwar$article_date)
# 1. Keep only article_date and add source
df_ai        <- my_data_ai2        %>% select(article_date) %>% mutate(source = "AI")
df_elections <- my_data_elections2 %>% select(article_date) %>% mutate(source = "Elections")
df_covid     <- my_data_covid2     %>% select(article_date) %>% mutate(source = "COVID")
df_ruwar     <- my_data_RUwar2     %>% select(article_date) %>% mutate(source = "RUwar")
# 2. Ensure all article_date columns are Date
df_ai$article_date        <- as.Date(df_ai$article_date)
df_elections$article_date <- as.Date(df_elections$article_date)
df_covid$article_date     <- as.Date(df_covid$article_date)
df_ruwar$article_date     <- as.Date(df_ruwar$article_date)
# 3. Combine datasets
all_data <- bind_rows(df_ai, df_elections, df_covid, df_ruwar)
# 4. Density plot
ggplot(all_data, aes(x = as.numeric(article_date), color = source, fill = source)) +
geom_density(alpha = 0.3, na.rm = TRUE) +
scale_x_continuous(
name = "Article Date",
labels = function(x) as.Date(x, origin = "1970-01-01")
) +
labs(
title = "Density of Article Dates by Dataset",
y = "Density"
) +
theme_minimal()
date_bounds = bind_rows(
data.frame(source = "AI", date = as.Date(date_bounds_ai)),
data.frame(source = "Elections", date = as.Date(date_bounds_elections)),
data.frame(source = "COVID", date = as.Date(date_bounds_covid)),
data.frame(source = "RUwar", date = as.Date(date_bounds_RUwar))
)
date_bounds_AI <- my_data_ai1 %>%
mutate(date_num = as.numeric(article_date)) %>%
summarise(
lower = as.Date(quantile(date_num, 0.025, na.rm = TRUE), origin = "1970-01-01"),
upper = as.Date(quantile(date_num, 0.975, na.rm = TRUE), origin = "1970-01-01")
)
date_bounds_AI
date_bounds = bind_rows(
data.frame(source = "AI", date = as.Date(date_bounds_AI)),
data.frame(source = "Elections", date = as.Date(date_bounds_elections)),
data.frame(source = "COVID", date = as.Date(date_bounds_covid)),
data.frame(source = "RUwar", date = as.Date(date_bounds_RUwar))
)
# Prepare a data frame of vertical lines from your existing bounds
vlines <- bind_rows(
data.frame(source = "AI",    date = c(date_bounds_ai$lower, date_bounds_ai$upper)),
data.frame(source = "Elections", date = c(date_bounds_elections$lower, date_bounds_elections$upper)),
data.frame(source = "COVID", date = c(date_bounds_covid$lower, date_bounds_covid$upper)),
data.frame(source = "RUwar", date = c(date_bounds_RUwar$lower, date_bounds_RUwar$upper))
)
# Prepare a data frame of vertical lines from your existing bounds
vlines <- bind_rows(
data.frame(source = "AI",    date = c(date_bounds_AI$lower, date_bounds_AI$upper)),
data.frame(source = "Elections", date = c(date_bounds_elections$lower, date_bounds_elections$upper)),
data.frame(source = "COVID", date = c(date_bounds_covid$lower, date_bounds_covid$upper)),
data.frame(source = "RUwar", date = c(date_bounds_RUwar$lower, date_bounds_RUwar$upper))
)
# Density plot with vertical lines for 95% bounds
ggplot(all_data, aes(x = as.numeric(article_date), color = source, fill = source)) +
geom_density(alpha = 0.3, na.rm = TRUE) +
geom_vline(
data = vlines,
aes(xintercept = as.numeric(date), color = source),
linetype = "dashed",
size = 0.8
) +
scale_x_continuous(
name = "Article Date",
labels = function(x) as.Date(x, origin = "1970-01-01")
) +
labs(
title = "Density of Article Dates by Dataset with 95% Bounds",
y = "Density"
) +
theme_minimal()
